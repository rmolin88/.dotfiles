# File:					muttrc
# Description:			Mutt configuration
# Author:				Reinaldo Molina <rmolin88@gmail.com>
# Version:				1.0.0
# Last Modified: Sun Jul 16 2017 18:27
# Created:				Jun 25 2017 13:20
# FAQ:
# - See `:Man muttrc` for help
# - /var/spool/mail/<USER> does not exist/is not a mailbox
# - You skipped putting gnupg password. Close terminal and start again
# - Selecting multiple messages
# You can also use t to tag or untag the highlighted message, to fine-tune the selection.
# Then you can run tag-prefix (;) followed by save-message (s), and it will prompt you for a mailbox name
# Fri Jun 30 2017 14:47: Super awesome discovery:
# - F toogles the message important flag
# - With Gmail this flagged is linked to the Starred Documents

set realname='Reinaldo Molina'
set ssl_starttls=yes
set ssl_force_tls=yes

# Add accounts
folder-hook 'gmail.com' 'source ~/.config/mutt/account.gmail'
folder-hook 'psu.edu' 'source ~/.config/mutt/account.psu'

# Default account to open
# source ~/.config/mutt/psu/account.psu
# source ~/.config/mutt/gmail/account.gmail

set copy=yes			# always save a copy of outgoing messages
set move = no

# Keep IMAP connection alive by polling intermittently (time in seconds).
set imap_keepalive = 30

# Allow Mutt to open new imap connection automatically.
unset imap_passive

# How often to check for new mail (time in seconds).
set timeout = 30
set mail_check = 30

# Check for all subscribed IMAP folders (as if all were added with a mailboxes line):
set imap_check_subscribed="yes"
set imap_list_subscribed="yes"

# To see both reply and recv in one thread
# I dont like this option. Makes sent emails show in gmail app
# fcc-hook .* =inbox

# Sort to show most recent first
set sort = reverse-date-received

# Email list mappings
bind index gg first-entry
bind index o display-message
bind index G last-entry
bind index L bottom-page		#to the bottom,
bind index M middle-page		#middle, and
bind index H top-page			#top of the screen
bind index r sync-mailbox
# Move the highlight to the previous mailbox
bind index h sidebar-prev
# Move the highlight to the next mailbox
bind index l sidebar-next
# Open the highlighted mailbox
bind index <return> sidebar-open
# Unmark all deletes
macro index u "U~A<enter>"
# Bind to I key in index view:
macro index I  "<search>~F\n"                     "Search for next important"
bind index J next-unread
bind index K previous-unread
# bind index c compose

bind index,pager N search-opposite
bind index,pager d next-page
bind index,pager e previous-page
bind index,pager D delete-message

# Inside emails mappings
bind pager j next-line
bind pager k previous-line
bind pager G bottom
bind pager gg top
bind pager gr group-reply
# Bint to I key in pager:
macro pager I  "<exit><search>~F\n<display-message>" "Jump to next important"

# Mappings for both
# Mark message as Done
# bind index,pager m noop
# macro index,pager md "<save-message>=INBOX<enter>"
# Mario Holbe suggests:
macro index b '<enter-command>toggle sidebar_visible<enter><refresh>'
macro pager b '<enter-command>toggle sidebar_visible<enter><redraw-screen>'

# Option to Save contacts so that autocompletion is possible
set display_filter='~/.config/mutt/mutt.save.contacts.sh'
# Options to load aliasses file
set alias_file= ~/.local/share/mutt/aliases.txt
set sort_alias= alias
set reverse_alias=yes
source $alias_file

# Tue Sep 12 2017 16:54: This in conjunction with the bashrc $VISUAL setting allows for using mutt
# inside of nvim
# set editor=$VISUAL
# Sun Oct 01 2017 08:02: Since mutt has its own scratchpad there is no need for this setting
# anymore.
set editor='nvim'

# From https://github.com/bubbl/bubb-confs/blob/master/mutt/.mutt/general
# A lot of good configs in that link
set edit_headers    = yes                # show headers when composing
set fast_reply                           # skip to compose when replying

# Always include previous message when replying
set include = yes

set menu_scroll

# If an opttion does not work search the manual. It may appear in different
# types of options. You just need to put it in th correct one.
set beep_new

# Pretty cool colors
# source ~/.config/mutt/mutt-solarized-colors.muttrc
source ~/.config/mutt/mutt-colors-neonwolf-256.muttrc

# Only new and read msgs
# Use $ to synch
set mark_old=no

# Setup to view html. Remember to install w3m
auto_view text/html
alternative_order text/plain text/enriched text/html
# bind attach <return>    view-mailcap
set mailcap_path=~/.config/mutt/mailcap

# Side-bar
#/usr/share/doc/mutt/samples/sample.muttrc-sidebar
# Sat Jul 15 2017 20:06 Dont like the sidebar visible all the time
set sidebar_visible=no
# Signature
# Fri Jun 30 2017 14:18: Doesnt work because it goes to the bottom of the reply chain
# set signature='~/.config/mutt/signature'

# No annoying pop-ups
set confirmappend=no
set delete=yes

# Stop asking annoying To: questions
set autoedit

# Sat Nov 04 2017 12:54: Neomutt only feature
set new_mail_command="notify-send 'New Email in %f' '%n new messages, %u unread.' && mpg123 ~/.config/dotfiles/notification_sounds/cool_notification0.mp3 2>/dev/null&"
# set new_mail_command="twmnc -t 'New Email' -c '%n new messages, %u unread.' && mpg123 ~/.config/twmn/cool_notification0.mp3&"

# Speed up folders switch
set sleep_time = 0

# Nice time formats
set date_format="%m-%d-%y %T"
set index_format="%2C | %Z [%d] %-30.30F (%-4.4c) %s"

# Display the index above the pager view
set pager_index_lines=10

set send_charset="utf-8"
set charset="utf-8"
set assumed_charset="utf-8"

# Stop at the end instead of displaying next mail:
set pager_stop=yes

# Show context lines when going to next page:
set pager_context=3
