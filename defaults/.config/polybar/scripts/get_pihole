#!/usr/bin/env python

import requests
import sys


class PiHole(object):
    """
    Gets pihole data, using the 'summary' API request.
    """

    def __init__(self, ip_add):
        """
        Gets pihole data, using the 'summary' API request.
        """

        self.data = dict()
        self.url = ''
        if not ip_add:
            return

        self.url = 'http://' + ip_add + '/admin/api.php?summary'

    def get_raw_data(self):
        """
        Returns dict with pihole data, using the 'summary' API request.
        """
        if not self.url:
            return list()
        try:
            resp = requests.get(self.url)
        except Exception:
            print('Invalid Host')
            return list()

        try:
            data = resp.json()
        except Exception:
            print('Invalid response')
            return list()

        print(type(data))
        return data


if __name__ == '__main__':
    # TODO get args ip address
    hole = PiHole('192.168.128.199')
    dhole = hole.get_raw_data()
    if not dhole:
        sys.exit(1)
    print(dhole)
